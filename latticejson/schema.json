{
  "$id": "https://raw.githubusercontent.com/nobeam/latticejson/master/latticejson/schema.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "LatticeJSON Schema, version 2.1",
  "description": "A JSON based lattice file format",
  "additionalProperties": false,
  "required": [
    "version",
    "root",
    "lattices",
    "elements"
  ],
  "type": "object",
  "properties": {
    "version": {
      "type": "string",
      "pattern": "^2.[0-1]$",
      "description": "LatticeJSON version"
    },
    "title": {
      "type": "string",
      "description": "The title of the lattice"
    },
    "info": {
      "type": "string",
      "description": "Additional information about the lattice"
    },
    "energy": {
      "type": "number",
      "description": "Energy of the particle beam in GeV",
      "minimum": 0
    },
    "root": {
      "type": "string",
      "description": "The root lattice"
    },
    "lattices": {
      "type": "object",
      "description": "Definition of the lattice and sub-lattices",
      "patternProperties": {
        "^.*$": {
          "$ref": "#/definitions/Lattice"
        }
      },
      "additionalProperties": false
    },
    "elements": {
      "type": "object",
      "description": "Definition of the elements",
      "patternProperties": {
        "^.*$": {
          "oneOf": [
            {
              "$ref": "#/definitions/Monitor"
            },
            {
              "$ref": "#/definitions/Marker"
            },
            {
              "$ref": "#/definitions/Drift"
            },
            {
              "$ref": "#/definitions/Hcor"
            },
            {
              "$ref": "#/definitions/Vcor"
            },
            {
              "$ref": "#/definitions/Kicker"
            },
            {
              "$ref": "#/definitions/Dipole"
            },
            {
              "$ref": "#/definitions/Quadrupole"
            },
            {
              "$ref": "#/definitions/Sextupole"
            },
            {
              "$ref": "#/definitions/Octupole"
            },
            {
              "$ref": "#/definitions/Multipole"
            },
            {
              "$ref": "#/definitions/Cavity"
            }
          ]
        }
      }
    }
  },
  "definitions": {
    "Lattice": {
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "Element": {
      "description": "Abstract base for all elements",
      "type": "array",
      "items": [
        {
          "type": "string"
        },
        {
          "type": "object",
          "required": [
            "length"
          ],
          "properties": {
            "info": {
              "type": "string",
              "description": "Additional information about the element."
            },
            "length": {
              "type": "number",
              "description": "The length of the element."
            },
            "dx": {
              "type": "number",
              "description": "Horizontal misalignment"
            },
            "dy": {
              "type": "number",
              "description": "Vertical misalignment"
            },
            "ds": {
              "type": "number",
              "description": "Longitudinal misalignment"
            },
            "tilt": {
              "type": "number",
              "description": "Rotation about the longitudinal axis"
            }
          }
        }
      ]
    },
    "Monitor": {
      "items": [
        {
          "const": "Monitor"
        },
        {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "info": {},
            "length": {},
            "dx": {},
            "dy": {},
            "ds": {},
            "tilt": {}
          }
        }
      ]
    },
    "Marker": {
      "items": [
        {
          "const": "Marker"
        },
        {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "info": {},
            "length": {},
            "dx": {},
            "dy": {},
            "ds": {},
            "tilt": {}
          }
        }
      ]
    },
    "Drift": {
      "allOf": [
        {
          "$ref": "#/definitions/Element"
        }
      ],
      "items": [
        {
          "const": "Drift"
        },
        {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "info": {},
            "length": {},
            "dx": {},
            "dy": {},
            "ds": {},
            "tilt": {}
          }
        }
      ]
    },
    "Hcor": {
      "items": [
        {
          "const": "Hcor"
        },
        {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "info": {},
            "length": {},
            "kick": {},
            "tilt": {}
          }
        }
      ]
    },
    "Vcor": {
      "items": [
        {
          "const": "Vcor"
        },
        {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "info": {},
            "length": {},
            "kick": {},
            "tilt": {}
          }
        }
      ]
    },
    "Kicker": {
      "items": [
        {
          "const": "Kicker"
        },
        {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "info": {},
            "length": {},
            "hkick": {},
            "vkick": {},
            "tilt": {}
          }
        }
      ]
    },
    "Dipole": {
      "allOf": [
        {
          "$ref": "#/definitions/Element"
        }
      ],
      "items": [
        {
          "const": "Dipole"
        },
        {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "info": {},
            "length": {},
            "dx": {},
            "dy": {},
            "ds": {},
            "tilt": {},
            "angle": {
              "type": "number",
              "description": "Deflection angle"
            },
            "k1": {
              "type": "number"
            },
            "radius": {
              "type": "number",
              "description": "Radius of curvature"
            },
            "e1": {
              "type": "number"
            },
            "e2": {
              "type": "number"
            },
            "h1": {
              "type": "number"
            },
            "h2": {
              "type": "number"
            },
            "fint": {
              "type": "number"
            },
            "hgap": {
              "type": "number"
            },
            "h": {},
            "harmon": {},
            "conversion_factor_ps_value": {
              "type": "number"
            }
          }
        }
      ]
    },
    "Quadrupole": {
      "allOf": [
        {
          "$ref": "#/definitions/Element"
        }
      ],
      "items": [
        {
          "const": "Quadrupole"
        },
        {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "info": {},
            "length": {},
            "dx": {},
            "dy": {},
            "ds": {},
            "tilt": {},
            "k1": {
              "type": "number",
              "description": "Geometric quadrupole strength"
            },
            "k1s": {
              "type": "number",
              "description": "Geometric quadrupole strength"
            },
            "conversion_factor_ps_value": {
              "type": "number"
            }
          }
        }
      ]
    },
    "Sextupole": {
      "allOf": [
        {
          "$ref": "#/definitions/Element"
        }
      ],
      "items": [
        {
          "const": "Sextupole"
        },
        {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "info": {},
            "length": {},
            "dx": {},
            "dy": {},
            "ds": {},
            "tilt": {},
            "k2": {
              "type": "number",
              "description": "Geometric sextupole strength"
            },
            "conversion_factor_ps_value": {
              "type": "number"
            }
          }
        }
      ]
    },
    "Octupole": {
      "allOf": [
        {
          "$ref": "#/definitions/Element"
        }
      ],
      "items": [
        {
          "const": "Octupole"
        },
        {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "info": {},
            "length": {},
            "dx": {},
            "dy": {},
            "ds": {},
            "tilt": {},
            "k3": {
              "type": "number",
              "description": "Geometric octupole strength"
            },
            "conversion_factor_ps_value": {
              "type": "number"
            }
          }
        }
      ]
    },
    "Multipole": {
      "items": [
        {
          "const": "Multipole"
        },
        {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "info": {},
            "length": {},
            "dx": {},
            "dy": {},
            "ds": {},
            "tilt": {},
            "knl": {},
            "order": {},
            "conversion_factor_ps_value": {
              "type": "number"
            }
          }
        }
      ]
    },
    "Cavity": {
      "items": [
        {
          "const": "Cavity"
        },
        {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "frequency"
          ],
          "properties": {
            "info": {},
            "length": {},
            "dx": {},
            "dy": {},
            "ds": {},
            "tilt": {},
            "voltage": {
              "type": "number"
            },
            "frequency": {
              "type": "number"
            },
            "phase": {
              "type": "number"
            },
            "fiducial": {
              "type": "string"
            },
            "end1_focus": {
              "type": "number"
            },
            "end2_foucs": {
              "type": "number"
            },
            "harmon": {},
            "no_cavity_totalpath": {}
          }
        }
      ]
    }
  }
}